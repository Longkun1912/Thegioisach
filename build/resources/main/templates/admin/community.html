<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" >
    <title>Community Page</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/admin/dashboard.css}" />
    <link rel="stylesheet" th:href="@{/css/admin/community.css}" />
    <link rel="stylesheet" th:href="@{/css/admin/rating-modal.css}" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
</head>
<body>
    <div th:replace="admin/menu :: menuBar"></div>
    <section class="home-section">
        <nav>
            <div class="sidebar-button">
                <i class='bx bx-menu sidebarBtn'></i>
                <span>Community</span>
            </div>
            <button id="personal-profile" th:onclick="window.location.href='/admin/logout'">
                <span style="border-right: 1px solid #ccc; padding-right: 10px;" th:text="${user_detail.username}"></span>
                <span id="personal-role" th:text="${role}"></span>
            </button>
        </nav>
        <div id="community-page">
            <div id="community-welcome">
                <h1>Thegioisach Feed</h1>
            </div>
            <div id="create-post">
                <div id="user-avatar">
                    <img th:if="${mimeType != null and mimeType.startsWith('image/')}"
                         th:src="'data:' + ${mimeType} + ';base64,' + ${base64EncodedImage}"
                         class="user-image"
                    />
                </div>
                <div id="create-content">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" aria-label="Default"
                               th:placeholder="'Share what is on your mind, ' + ${user_detail.username} + '...'"
                               aria-describedby="inputGroup-sizing-default" id="input-content" readonly
                        >
                    </div>
                </div>
            </div>
            <div id="post-container">
                <ul style="list-style: none; margin-top: 30px;">
                    <li th:each="post : ${posts}" style="background-color: white; border-radius: 12px; margin-top: 5%;">
                        <div class="community-post">
                            <div class="post-intro">
                                <div class="creator-image">
                                    <img
                                            th:if="${post.creator_detail.userImageData.mimeType != null and post.creator_detail.userImageData.mimeType.startsWith('image/')}"
                                            th:src="'data:' + ${post.creator_detail.userImageData.mimeType} + ';base64,' + ${post.creator_detail.userImageData.base64EncodedImage}"
                                            style="width: 80px; height: 80px; border-radius: 50%;"
                                    />
                                </div>
                                <div class="other-intro">
                                    <h1 style="font-family: sans-serif; font-size: 25px;" th:text="${post.creator_detail.username}"></h1>
                                    <h2 style="font-family: sans-serif; font-size: 15px; color: darkgrey;" th:text="${post.last_updated}"></h2>
                                </div>
                                <div class="post-action">

                                </div>
                            </div>
                            <div class="post-content">
                                <h1 style="font-family: sans-serif; font-size: 25px;" th:text="${post.title}"></h1>
                                <img
                                        th:if="${post.postImageData != null and post.postImageData.mimeType != null and post.postImageData.mimeType.startsWith('image/')}"
                                        th:src="'data:' + ${post.postImageData.mimeType} + ';base64,' + ${post.postImageData.base64EncodedImage}"
                                        class="post-image"
                                />
                                <p style="font-family: sans-serif; font-size: 15px;" th:utext="${post.content_text}"></p>
                            </div>
                            <div class="post-reaction">
                                <div class="provide-reaction">
                                    <h1 class="reaction-question">Is this helpful ?</h1>
                                    <button type="button" class="btn btn-secondary"
                                            data-toggle="modal" th:data-target="'#ratingStar-' + ${post.id}"
                                            style="height: 40px; margin-right: 10px;"
                                    >
                                        Rate this post
                                    </button>
                                    <button type="button" class="btn btn-secondary"
                                            data-toggle="modal" th:data-target="'#leaveComment-' + ${post.id}"
                                            style="height: 40px; margin-right: 10px;"
                                    >
                                        Leave a comment
                                    </button>
                                    <button type="button" class="btn btn-secondary"
                                            data-toggle="modal" th:data-target="'#sharePost-' + ${post.id}"
                                            style="height: 40px; margin-right: 10px;"
                                    >
                                        Share
                                    </button>
                                    <div th:replace="admin/rating-modal :: rating-star" th:with="post=${post}"></div>
                                    <div th:replace="admin/comment-form :: comment-form" th:with="post=${post}"></div>
                                </div>
                                <div class="average-star">

                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </section>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</body>
</html>